{"version":3,"sources":["../src/types.ts","../src/patterns.ts","../src/audit-agent.ts"],"sourcesContent":["import { z } from \"zod\";\n\nexport const VulnerabilitySeverity = z.enum([\n  \"critical\",\n  \"high\",\n  \"medium\",\n  \"low\",\n  \"informational\",\n]);\nexport type VulnerabilitySeverity = z.infer<typeof VulnerabilitySeverity>;\n\nexport const VulnerabilityCategory = z.enum([\n  \"reentrancy\",\n  \"overflow\",\n  \"access_control\",\n  \"oracle_manipulation\",\n  \"front_running\",\n  \"dos\",\n  \"logic_error\",\n  \"gas_optimization\",\n  \"centralization\",\n  \"unchecked_return\",\n  \"timestamp_dependency\",\n  \"arbitrary_send\",\n  \"missing_validation\",\n]);\nexport type VulnerabilityCategory = z.infer<typeof VulnerabilityCategory>;\n\nexport const VulnerabilitySchema = z.object({\n  id: z.string(),\n  title: z.string(),\n  severity: VulnerabilitySeverity,\n  category: VulnerabilityCategory,\n  description: z.string(),\n  location: z.object({\n    file: z.string().optional(),\n    line: z.number().optional(),\n    function: z.string().optional(),\n  }),\n  recommendation: z.string(),\n  references: z.array(z.string()).optional(),\n});\nexport type Vulnerability = z.infer<typeof VulnerabilitySchema>;\n\nexport const AuditResultSchema = z.object({\n  contractName: z.string(),\n  language: z.enum([\"solidity\", \"rust\", \"move\"]),\n  vulnerabilities: z.array(VulnerabilitySchema),\n  gasOptimizations: z.array(\n    z.object({\n      description: z.string(),\n      estimatedSavings: z.string().optional(),\n      location: z.string().optional(),\n    })\n  ),\n  summary: z.object({\n    critical: z.number(),\n    high: z.number(),\n    medium: z.number(),\n    low: z.number(),\n    informational: z.number(),\n  }),\n  overallRisk: z.enum([\"critical\", \"high\", \"medium\", \"low\", \"safe\"]),\n  timestamp: z.number(),\n});\nexport type AuditResult = z.infer<typeof AuditResultSchema>;\n\nexport interface AuditConfig {\n  checkReentrancy?: boolean;\n  checkOverflow?: boolean;\n  checkAccessControl?: boolean;\n  checkGasOptimization?: boolean;\n  runSlither?: boolean;\n  runMythril?: boolean;\n}\n","import type { VulnerabilityCategory, VulnerabilitySeverity } from \"./types.js\";\n\nexport interface VulnerabilityPattern {\n  name: string;\n  category: VulnerabilityCategory;\n  severity: VulnerabilitySeverity;\n  pattern: RegExp;\n  description: string;\n  recommendation: string;\n}\n\nexport const SOLIDITY_PATTERNS: VulnerabilityPattern[] = [\n  {\n    name: \"Reentrancy via external call before state update\",\n    category: \"reentrancy\",\n    severity: \"critical\",\n    pattern: /\\.call\\{.*value.*\\}\\s*\\([^)]*\\)[^;]*;[\\s\\S]*?=\\s*[^;]+;/,\n    description:\n      \"External call made before state variables are updated, enabling reentrancy attacks\",\n    recommendation:\n      \"Follow checks-effects-interactions pattern. Update state before external calls or use ReentrancyGuard.\",\n  },\n  {\n    name: \"Unchecked call return value\",\n    category: \"unchecked_return\",\n    severity: \"high\",\n    pattern: /\\.call\\{[^}]*\\}\\([^)]*\\)\\s*;(?!\\s*require)/,\n    description: \"Return value of low-level call is not checked\",\n    recommendation:\n      \"Check the return value: (bool success, ) = addr.call{...}(...); require(success);\",\n  },\n  {\n    name: \"tx.origin authentication\",\n    category: \"access_control\",\n    severity: \"critical\",\n    pattern: /require\\s*\\(\\s*tx\\.origin\\s*==|tx\\.origin\\s*==\\s*owner/,\n    description:\n      \"Using tx.origin for authentication is vulnerable to phishing attacks\",\n    recommendation: \"Use msg.sender instead of tx.origin for authentication\",\n  },\n  {\n    name: \"Unprotected selfdestruct\",\n    category: \"access_control\",\n    severity: \"critical\",\n    pattern: /selfdestruct\\s*\\([^)]+\\)/,\n    description: \"selfdestruct can permanently destroy the contract\",\n    recommendation:\n      \"Add access control or consider if selfdestruct is really needed\",\n  },\n  {\n    name: \"Weak randomness using block variables\",\n    category: \"oracle_manipulation\",\n    severity: \"high\",\n    pattern:\n      /block\\.(timestamp|number|difficulty|prevrandao)|blockhash\\s*\\(/,\n    description:\n      \"Block variables can be manipulated by miners for predictable randomness\",\n    recommendation: \"Use Chainlink VRF or commit-reveal scheme for randomness\",\n  },\n  {\n    name: \"Integer overflow/underflow\",\n    category: \"overflow\",\n    severity: \"high\",\n    pattern: /pragma solidity\\s*[\\^~>=<]*\\s*0\\.[0-7]\\./,\n    description:\n      \"Solidity <0.8.0 is vulnerable to integer overflow/underflow\",\n    recommendation: \"Upgrade to Solidity >=0.8.0 or use SafeMath library\",\n  },\n  {\n    name: \"Uninitialized storage pointer\",\n    category: \"logic_error\",\n    severity: \"high\",\n    pattern: /(\\w+)\\s+storage\\s+\\w+\\s*;(?!\\s*=)/,\n    description: \"Uninitialized storage pointer may point to unexpected data\",\n    recommendation: \"Always initialize storage pointers or use memory\",\n  },\n  {\n    name: \"Delegatecall to untrusted contract\",\n    category: \"arbitrary_send\",\n    severity: \"critical\",\n    pattern: /\\.delegatecall\\s*\\(/,\n    description: \"delegatecall executes code in caller's context\",\n    recommendation:\n      \"Only delegatecall to trusted, immutable implementation contracts\",\n  },\n  {\n    name: \"Missing zero address check\",\n    category: \"missing_validation\",\n    severity: \"medium\",\n    pattern:\n      /function\\s+\\w+\\s*\\([^)]*address\\s+\\w+[^)]*\\)\\s*(?:external|public)[^{]*\\{(?![^}]*require\\s*\\([^)]*!=\\s*address\\s*\\(\\s*0\\s*\\))/,\n    description: \"Function accepts address parameter without zero-check\",\n    recommendation:\n      \"Add require(addr != address(0)) for address parameters\",\n  },\n  {\n    name: \"Public function that should be external\",\n    category: \"gas_optimization\",\n    severity: \"informational\",\n    pattern: /function\\s+\\w+\\s*\\([^)]*\\)\\s*public\\s+(?!view|pure)/,\n    description: \"Public functions cost more gas than external for large inputs\",\n    recommendation:\n      \"Use external instead of public for functions not called internally\",\n  },\n  {\n    name: \"Multiple storage reads\",\n    category: \"gas_optimization\",\n    severity: \"informational\",\n    pattern: /(\\w+)\\[[\\w\\[\\]]+\\][\\s\\S]*\\1\\[[\\w\\[\\]]+\\][\\s\\S]*\\1\\[[\\w\\[\\]]+\\]/,\n    description: \"Multiple reads of same storage variable\",\n    recommendation: \"Cache storage variable in memory for multiple reads\",\n  },\n];\n\nexport const RUST_ANCHOR_PATTERNS: VulnerabilityPattern[] = [\n  {\n    name: \"Missing signer check\",\n    category: \"access_control\",\n    severity: \"critical\",\n    pattern: /pub\\s+\\w+:\\s*Account<'info,\\s*\\w+>(?!.*#\\[account\\(.*signer.*\\)\\])/,\n    description: \"Account lacks signer constraint\",\n    recommendation: \"Add #[account(signer)] or Signer type\",\n  },\n  {\n    name: \"Missing owner check\",\n    category: \"access_control\",\n    severity: \"high\",\n    pattern: /ctx\\.accounts\\.\\w+\\.key\\(\\)(?![\\s\\S]*owner)/,\n    description: \"Account ownership not verified\",\n    recommendation: \"Add owner constraint in account validation\",\n  },\n  {\n    name: \"Unchecked arithmetic\",\n    category: \"overflow\",\n    severity: \"medium\",\n    pattern: /\\+\\s*\\d+|\\-\\s*\\d+|\\*\\s*\\d+/,\n    description: \"Arithmetic operation without checked_* methods\",\n    recommendation:\n      \"Use checked_add, checked_sub, checked_mul for arithmetic\",\n  },\n  {\n    name: \"Missing PDA bump verification\",\n    category: \"access_control\",\n    severity: \"high\",\n    pattern: /seeds\\s*=\\s*\\[[^\\]]+\\](?![\\s\\S]*bump)/,\n    description: \"PDA seeds without bump seed verification\",\n    recommendation: \"Include bump seed in PDA derivation\",\n  },\n];\n\nexport function detectVulnerabilities(\n  code: string,\n  language: \"solidity\" | \"rust\"\n): Array<{\n  pattern: VulnerabilityPattern;\n  matches: RegExpMatchArray[];\n}> {\n  const patterns =\n    language === \"solidity\" ? SOLIDITY_PATTERNS : RUST_ANCHOR_PATTERNS;\n  const results: Array<{\n    pattern: VulnerabilityPattern;\n    matches: RegExpMatchArray[];\n  }> = [];\n\n  for (const pattern of patterns) {\n    const matches = [...code.matchAll(new RegExp(pattern.pattern, \"g\"))];\n    if (matches.length > 0) {\n      results.push({ pattern, matches });\n    }\n  }\n\n  return results;\n}\n","import {\n  BaseAgent,\n  type AgentConfig,\n  type AgentContext,\n  type AgentResult,\n  createLLMClient,\n  type LLMClient,\n} from \"@gicm/agent-core\";\nimport { detectVulnerabilities, SOLIDITY_PATTERNS } from \"./patterns.js\";\nimport type {\n  AuditConfig,\n  AuditResult,\n  Vulnerability,\n  VulnerabilitySeverity,\n} from \"./types.js\";\n\nexport class AuditAgent extends BaseAgent {\n  private auditConfig: AuditConfig;\n  private llmClient: LLMClient | null = null;\n\n  constructor(config: AgentConfig, auditConfig: AuditConfig = {}) {\n    super(\"audit-agent\", config);\n    this.auditConfig = {\n      checkReentrancy: true,\n      checkOverflow: true,\n      checkAccessControl: true,\n      checkGasOptimization: true,\n      ...auditConfig,\n    };\n\n    if (config.apiKey) {\n      this.llmClient = createLLMClient({\n        provider: config.llmProvider || \"openai\",\n        apiKey: config.apiKey,\n        model: config.llmModel,\n        temperature: 0.3,\n        maxTokens: 4096,\n      });\n    }\n  }\n\n  getSystemPrompt(): string {\n    return `You are an expert smart contract security auditor with deep knowledge of:\n- Solidity vulnerabilities (reentrancy, overflow, access control, etc.)\n- Rust/Anchor program security on Solana\n- Gas optimization techniques\n- Common attack vectors (flash loans, oracle manipulation, front-running)\n\nWhen analyzing code:\n1. Identify ALL security vulnerabilities, ranked by severity\n2. Explain each vulnerability clearly with line references\n3. Provide specific, actionable recommendations\n4. Suggest gas optimizations where applicable\n\nBe thorough but avoid false positives. Focus on real exploitable issues.\n\nResponse format: JSON with vulnerabilities array, each containing:\n- title, severity, category, description, location, recommendation`;\n  }\n\n  async analyze(context: AgentContext): Promise<AgentResult> {\n    const code = context.metadata?.code as string;\n    if (!code) {\n      return this.createResult(false, null, \"No code provided for audit\");\n    }\n\n    const language = this.detectLanguage(code);\n    const patternResults = detectVulnerabilities(code, language);\n\n    const vulnerabilities: Vulnerability[] = patternResults.map(\n      ({ pattern, matches }, idx) => ({\n        id: `VULN-${idx + 1}`,\n        title: pattern.name,\n        severity: pattern.severity,\n        category: pattern.category,\n        description: pattern.description,\n        location: {\n          line: this.getLineNumber(code, matches[0].index || 0),\n        },\n        recommendation: pattern.recommendation,\n      })\n    );\n\n    if (this.llmClient) {\n      const llmVulns = await this.performLLMAnalysis(code, language);\n      vulnerabilities.push(...llmVulns);\n    }\n\n    const auditResult = this.buildAuditResult(\n      context.metadata?.contractName as string || \"Unknown\",\n      language,\n      vulnerabilities\n    );\n\n    return this.createResult(\n      true,\n      auditResult,\n      undefined,\n      this.calculateConfidence(auditResult),\n      `Found ${vulnerabilities.length} potential issues`\n    );\n  }\n\n  private detectLanguage(code: string): \"solidity\" | \"rust\" {\n    if (code.includes(\"pragma solidity\") || code.includes(\"contract \")) {\n      return \"solidity\";\n    }\n    if (\n      code.includes(\"#[program]\") ||\n      code.includes(\"use anchor_lang\") ||\n      code.includes(\"fn \")\n    ) {\n      return \"rust\";\n    }\n    return \"solidity\";\n  }\n\n  private getLineNumber(code: string, index: number): number {\n    return code.slice(0, index).split(\"\\n\").length;\n  }\n\n  private async performLLMAnalysis(\n    code: string,\n    language: string\n  ): Promise<Vulnerability[]> {\n    if (!this.llmClient) return [];\n\n    try {\n      const prompt = `Analyze this ${language} smart contract for security vulnerabilities:\n\n\\`\\`\\`${language}\n${code.slice(0, 8000)}\n\\`\\`\\`\n\nReturn ONLY a JSON array of vulnerabilities found. Each object must have:\n- id: string\n- title: string\n- severity: \"critical\" | \"high\" | \"medium\" | \"low\" | \"informational\"\n- category: string\n- description: string\n- location: { line?: number, function?: string }\n- recommendation: string\n\nIf no vulnerabilities found, return empty array [].`;\n\n      const response = await this.llmClient.complete(prompt);\n      const parsed = this.parseJSON<Vulnerability[]>(response);\n      return parsed || [];\n    } catch (error) {\n      this.log(\"LLM analysis failed\", error);\n      return [];\n    }\n  }\n\n  private buildAuditResult(\n    contractName: string,\n    language: \"solidity\" | \"rust\",\n    vulnerabilities: Vulnerability[]\n  ): AuditResult {\n    const summary = {\n      critical: 0,\n      high: 0,\n      medium: 0,\n      low: 0,\n      informational: 0,\n    };\n\n    for (const vuln of vulnerabilities) {\n      summary[vuln.severity]++;\n    }\n\n    const gasOptimizations = vulnerabilities\n      .filter((v) => v.category === \"gas_optimization\")\n      .map((v) => ({\n        description: v.description,\n        location: v.location.function || `Line ${v.location.line}`,\n      }));\n\n    let overallRisk: AuditResult[\"overallRisk\"] = \"safe\";\n    if (summary.critical > 0) overallRisk = \"critical\";\n    else if (summary.high > 0) overallRisk = \"high\";\n    else if (summary.medium > 0) overallRisk = \"medium\";\n    else if (summary.low > 0) overallRisk = \"low\";\n\n    return {\n      contractName,\n      language,\n      vulnerabilities: vulnerabilities.filter(\n        (v) => v.category !== \"gas_optimization\"\n      ),\n      gasOptimizations,\n      summary,\n      overallRisk,\n      timestamp: Date.now(),\n    };\n  }\n\n  private calculateConfidence(result: AuditResult): number {\n    const patternBased = result.vulnerabilities.filter((v) =>\n      SOLIDITY_PATTERNS.some((p) => p.name === v.title)\n    ).length;\n    const total = result.vulnerabilities.length;\n\n    if (total === 0) return 0.7;\n    return 0.6 + (patternBased / total) * 0.3;\n  }\n\n  async auditCode(\n    code: string,\n    contractName = \"Contract\"\n  ): Promise<AuditResult> {\n    const result = await this.analyze({\n      chain: \"evm\",\n      network: \"mainnet\",\n      metadata: { code, contractName },\n    });\n\n    return result.data as AuditResult;\n  }\n}\n"],"mappings":"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","names":[]}